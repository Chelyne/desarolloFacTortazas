<ion-header class="ion-no-border">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="cerrarModal()">
        <ion-icon color="primary" slot="icon-only" name="arrow-back-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>Agregar {{subCategoria | titlecase}}</ion-title>
    <!-- <ion-toggle slot="end" color="primary"></ion-toggle>  GUARDADO PARA SUBIR IMAGENES PNG CON COLOR DE FONDO DINAMICO-->
  </ion-toolbar>
</ion-header>

<ion-content fullscreen>
  <form [formGroup] ="productoForm">
    <!-- [style.background-color]="colorFondo" -->
    <div class="datos">
      <!-- <ion-slides *ngIf="listaImgenes.length>0">
        <ion-slide class="fotoProducto" (click)="SubirFoto()"  *ngFor="let imagen of listaImgenes">
          <img [src]="imagen" alt="producto">
        </ion-slide>
      </ion-slides> -->
      <div class="fotoProducto">
        <img (click)="SubirFoto()" *ngIf="!image" src="../../../assets/fondoImg.jpg" alt="">
        <img (click)="SubirFoto()" *ngIf="image" src="{{image}}" alt="foto">
      </div>
      <div class="alertDanger" *ngIf="sinFoto">
        <div class="mensajeError" >
          {{sinFoto}}
        </div>
      </div>
      <div class="datosProducto">
        <ion-item lines="none">
          <ion-input maxLength="35" formControlName="nombre" class="nombre" placeholder="Nombre del producto o servicio"></ion-input>
          <!-- <ion-buttons slot="end">
            <ion-button>
              <ion-icon slot="icon-only" name="arrow-redo-outline" color="medium"></ion-icon>
            </ion-button>
          </ion-buttons> -->
        </ion-item>
        <div class="alertDanger" *ngIf="nombre.invalid && (nombre.dirty || nombre.touched)">
          <div class="mensajeError" *ngIf="!!nombre.errors.required">
            Complete el nombre
          </div>
          <div class="mensajeError" *ngIf="!!nombre.errors.minlength">
            El nombre debe tener al menos 3 caracteres.
          </div>
          <div class="mensajeError" *ngIf="!!nombre.errors.maxlength">
            El nombre debe tener máximo 35 caracteres.
          </div>
        </div>
        <div class="cantidad">
          <ion-item>
            <ion-input formControlName="cantidad" type="number" placeholder="Cantidad"></ion-input>
            <ion-select formControlName="medida" placeholder="medida" cancelText="Cancelar" okText="Aceptar" mode="ios">
              <ion-select-option value="Gramos">Gramos</ion-select-option>
              <ion-select-option value="Kilogramo">Kilogramo</ion-select-option>
              <ion-select-option value="Litro">Litro</ion-select-option>
              <ion-select-option value="Unidad">Unidad</ion-select-option>
              <ion-select-option value="Caja">Caja</ion-select-option>
              <ion-select-option value="Paquete">Paquete</ion-select-option>
              <ion-select-option value="Saco">Saco</ion-select-option>
            </ion-select>
          </ion-item>
          <!-- <span>{{dataProducto.cantidad}} {{dataProducto.medida}}</span> -->
        </div>
        <div class="alertDanger" *ngIf="cantidad.invalid && (cantidad.dirty || cantidad.touched)">
          <div class="mensajeError" *ngIf="!!cantidad.errors.required">
            Complete la cantidad
          </div>
          <div class="mensajeError" *ngIf="!!cantidad.errors.min">
            La cantidad minima es 1
          </div>
        </div>
        <div class="alertDanger" *ngIf="medida.invalid && (medida.dirty || medida.touched)">
          <div class="mensajeError" *ngIf="!!medida.errors.required">
            Complete la medida
          </div>
        </div>
        <ion-item class="precio" lines="none" *ngIf="subCategoria !== 'farmacia'">
          <ion-label>S/.</ion-label>
          <ion-input [readonly]="tallas && tallas.length>0" formControlName="precio" type="number" placeholder="Precio"></ion-input>
          <!-- <ion-label class="precio"><span>S/.</span> {{dataProducto.precio | number: '1.2'}}</ion-label> -->
        </ion-item>
        <div class="alertDanger" *ngIf="precio.invalid && (precio.dirty || precio.touched)">
          <div class="mensajeError" *ngIf="!!precio.errors.required">
            Complete el precio
          </div>
        </div>
        <!-- *ngIf="!datosCarrito" -->
        <ion-item>
          <ion-label>Cantidad de stock: </ion-label>
          <ion-input [readonly]="tallas && tallas.length>0" formControlName="cantStock" type="number" placeholder="Stock"></ion-input>
        </ion-item>
        <div class="alertDanger" *ngIf="cantStock.invalid && (cantStock.dirty || cantStock.touched)">
          <div class="mensajeError" *ngIf="!!cantStock.errors.required">
            Ingrese la cantidad de stock
          </div>
          <div class="mensajeError" *ngIf="!!cantStock.errors.min">
            La cantidad minima en stock es 1
          </div>
        </div>
        <ion-button (click)="agregarDescripcion()" *ngIf="!descripcion" shape="round" fill="outline" expand="block">Agregar descripcion</ion-button>
        <ion-item *ngIf="descripcion">
          <ion-label position="floating">Descripción</ion-label>
          <ion-textarea formControlName="descripcionProducto" autoGrow="true" placeholder="Ingrese una descripción del producto..."></ion-textarea>
        </ion-item>
        <ion-button (click)="agregarTallas()" *ngIf="tallas===undefined && this.productoForm.value.precio && this.productoForm.value.cantStock" fill="clear">Agregar tallas, colores, etc.</ion-button>
        <ion-item *ngIf="tallas!==undefined">
          <ion-label color="primary">Que desea agregar?</ion-label>
          <ion-input [readonly]="tallas.length>0" formControlName="nombreTalla" type="text" placeholder="talla, color, etc."></ion-input>
        </ion-item>
        <!-- <div class="tallas" *ngIf="tallas!==undefined && this.productoForm.value.nombreTalla">
          <ion-row>
            <!-- <div *ngFor="let talla of tallas">
              <ion-badge>{{talla.talla}}
                <ion-icon name="close" (click)="quitarTalla(talla)"></ion-icon>
              </ion-badge> &nbsp;
            </div> -->
          <!-- </ion-row>
          <ion-row>
            <ion-col>
              <ion-item>
                <ion-label position="floating">{{this.productoForm.value.nombreTalla |titlecase}}</ion-label>
                <ion-input type="text" placeholder="{{this.productoForm.value.nombreTalla |titlecase}}" #inputTalla ></ion-input>
              </ion-item>
            </ion-col>
            <ion-col>
              <ion-item>
                <ion-label position="floating">Stock</ion-label>
                <ion-input type="number" placeholder="Stock" value="{{this.productoForm.value.cantStock}}" #inputInventario ></ion-input>
              </ion-item>
            </ion-col>
            <ion-col>
              <ion-item>
                <ion-label position="floating">Precio</ion-label>
                <ion-input type="number" placeholder="Precio" value="{{this.productoForm.value.precio}}" #inputPrecio ></ion-input>
              </ion-item>
            </ion-col>
          </ion-row>
          <ion-button size="small" expand="block" (click)="agregarTallas()">
            <ion-label color="light">Agregar</ion-label>
          </ion-button> -->
          <!-- <ion-item *ngIf="tallas.length<10">
            <ion-input type="text" placeholder="Agregue {{this.productoForm.value.nombreTalla |titlecase}} " #inputTalla ></ion-input>
            <ion-input type="text" placeholder="Agregue Stock" value="{{this.productoForm.value.cantStock}}" #inputInventario ></ion-input>
            <ion-input type="text" placeholder="Agregue precio" value="{{this.productoForm.value.precio}}" #inputPrecio ></ion-input>
            <ion-button (click)="agregarTallas()">Agregar</ion-button>
          </ion-item> -->
        <!-- </div> -->

        <div class="tallas" *ngIf="tallas!==undefined && this.productoForm.value.nombreTalla">
          <ion-row class="ion-margin">
            <div *ngFor="let talla of tallas">
              <ion-badge>{{talla}}
                <ion-icon name="close" (click)="quitarTalla(talla)"></ion-icon>
              </ion-badge> &nbsp;
            </div>
          </ion-row>
          <ion-item *ngIf="tallas.length<10">
            <ion-input type="text" placeholder="Agregue {{this.productoForm.value.nombreTalla |titlecase}} " #inputTalla ></ion-input>
            <ion-button (click)="agregarTallas()">Agregar</ion-button>
          </ion-item>
        </div>
        <!-- <div class="variantes" *ngIf="tallas && tallas.length>0">
          <ion-grid class="ion-text-center">
            <ion-row style="background-color: #75ceee;" class="ion-justify-content-center ion-align-items-center">
              <ion-col size-xs="3">{{this.productoForm.value.nombreTalla |titlecase}}</ion-col>
              <ion-col size-xs="3">Inventario</ion-col>
              <ion-col size-xs="3">Precio</ion-col>
              <ion-col size-xs="3">Quitar</ion-col>
            </ion-row>
            <ion-row style="background-color: #ececec; border-bottom: solid0.0.5px #201e1e;" class="ion-justify-content-center ion-align-items-center" *ngFor="let variante of tallas.reverse()">
              <ion-col size-xs="3">{{variante.talla}}</ion-col>
              <ion-col size-xs="3">
                <ion-label>{{variante.inventario}}</ion-label>
              </ion-col>
              <ion-col size-xs="3">
                <ion-label>{{variante.precio}}</ion-label>
              </ion-col>
              <ion-col size-xs="3">
                <ion-button fill="clear" (click)="quitarTalla(variante)">
                  <ion-icon color="danger" name="trash-outline"></ion-icon>
                </ion-button>
              </ion-col>
            </ion-row>
          </ion-grid>
        </div> -->
      </div> 
    </div>
  </form>
</ion-content>
<ion-footer class="ion-no-border footer">
  <div class="alertDanger" *ngIf="mensaje">
    <div class="mensajeError">
      {{mensaje}}
    </div>
  </div>
  <ion-button (click)="guardarProducto()" shape="round" expand="block">
    <ion-icon slot="icon-only" color="light" name="add-circle-outline"></ion-icon> &nbsp;
    <ion-label color="light">Agregar Producto</ion-label>
  </ion-button>
</ion-footer>
